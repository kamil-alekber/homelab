# Main Kustomization for Media Services
# This file orchestrates all media service deployments
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: media-services

# Base resources
resources:
- base/
- booklore/
- frames/
- fladder/
- rdtclient/
- cloudcmd/
- sonarr/
- radarr/
- lidarr/
- youtarr/
- listenarr/
- prowlarr/
- qbittorrent/
- sabnzbd/
- flaresolverr/
- jellyfin-media/
- profilarr/
- stash/
- homepage/
- sonobarr/
- glance/
- whisparr/
- monitoring/
- polaris/
- miniflux/
- watcharr/

labels:
- pairs:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/part-of: media-services

commonAnnotations:
  description: Media automation stack - Sonarr, Radarr, Lidarr, Prowlarr, qBittorrent, SABnzbd, Jellyfin, Jellyseerr, Profilarr
  documentation: See README.md for deployment instructions


patches:
- target:
    kind: IngressRoute
  patch: |-
    - op: add
      path: /spec/routes/0/middlewares
      value:
        - name: voidauth
          namespace: media-services
        
